# Trial and Error ê¸°ë¡

ì´ ë¬¸ì„œëŠ” nixos-config ì €ì¥ì†Œì—ì„œ ì‹œë„í–ˆë‹¤ê°€ ì‹¤íŒ¨í•œ ì‘ì—…ë“¤ì„ ê¸°ë¡í•©ë‹ˆë‹¤.

## ëª©ì°¨

- [2026-01-13: Atuin ë™ê¸°í™” ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬í˜„ ì‹œí–‰ì°©ì˜¤](#2026-01-13-atuin-ë™ê¸°í™”-ëª¨ë‹ˆí„°ë§-ì‹œìŠ¤í…œ-êµ¬í˜„-ì‹œí–‰ì°©ì˜¤)
- [2026-01-13: Atuin ê³„ì • ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨](#2026-01-13-atuin-ê³„ì •-ë§ˆì´ê·¸ë ˆì´ì…˜-ì‹¤íŒ¨)
- [2026-01-11: Claude Code ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸ í•´ê²°](#2026-01-11-claude-code-ìœ ë ¹-í”ŒëŸ¬ê·¸ì¸-í•´ê²°)
- [2026-01-10: cat â†’ bat alias ì œê±° (í˜¸í™˜ì„± ë¬¸ì œ)](#2026-01-10-cat--bat-alias-ì œê±°-í˜¸í™˜ì„±-ë¬¸ì œ)
- [2026-01-10: VS Code customLabelsì—ì„œ ë™ì  ì•± ì´ë¦„ ì¶”ì¶œ ì‹¤íŒ¨](#2026-01-10-vs-code-customlabelsì—ì„œ-ë™ì -ì•±-ì´ë¦„-ì¶”ì¶œ-ì‹¤íŒ¨)
- [2024-12-25: dutië¡œ .html/.htm ê¸°ë³¸ ì•± ì„¤ì • ì‹¤íŒ¨](#2024-12-25-dutië¡œ-htmlhtm-ê¸°ë³¸-ì•±-ì„¤ì •-ì‹¤íŒ¨)
- [2024-12-24: Anki ì• ë“œì˜¨ Nix ì„ ì–¸ì  ê´€ë¦¬ ì‹œë„ (ë³´ë¥˜)](#2024-12-24-anki-ì• ë“œì˜¨-nix-ì„ ì–¸ì -ê´€ë¦¬-ì‹œë„-ë³´ë¥˜)
  - [ëª©í‘œ](#ëª©í‘œ)
  - [ì‹œë„í•œ ë°©ì‹ë“¤](#ì‹œë„í•œ-ë°©ì‹ë“¤)
    - [ë°©ì‹ 1: AnkiWeb ì§ì ‘ ë‹¤ìš´ë¡œë“œ (ì‹¤íŒ¨)](#ë°©ì‹-1-ankiweb-ì§ì ‘-ë‹¤ìš´ë¡œë“œ-ì‹¤íŒ¨)
    - [ë°©ì‹ 2: ë¡œì»¬ ì†ŒìŠ¤ íŒ¨í‚¤ì§• (ë°˜ë ¤)](#ë°©ì‹-2-ë¡œì»¬-ì†ŒìŠ¤-íŒ¨í‚¤ì§•-ë°˜ë ¤)
    - [ë°©ì‹ 3: GitHub ì €ì¥ì†Œ í™œìš© (ë³´ë¥˜)](#ë°©ì‹-3-github-ì €ì¥ì†Œ-í™œìš©-ë³´ë¥˜)
  - [ë°©ì‹ 3ì˜ ì‹¤íŒ¨ ì›ì¸](#ë°©ì‹-3ì˜-ì‹¤íŒ¨-ì›ì¸)
  - [êµí›ˆ](#êµí›ˆ)
  - [ëŒ€ìƒ ì• ë“œì˜¨ ëª©ë¡ (ì°¸ê³ ìš©)](#ëŒ€ìƒ-ì• ë“œì˜¨-ëª©ë¡-ì°¸ê³ ìš©)
  - [ê²°ë¡ ](#ê²°ë¡ )

---

## 2026-01-13: Atuin ë™ê¸°í™” ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬í˜„ ì‹œí–‰ì°©ì˜¤

> **í…ŒìŠ¤íŠ¸ í™˜ê²½**: atuin 18.10.0, macOS (Apple Silicon)
>
> Atuin ë™ê¸°í™” ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ë©´ì„œ ë°œê²¬í•œ ì¤‘ìš”í•œ ì‚¬ì‹¤ë“¤ê³¼ ì‹œí–‰ì°©ì˜¤ë¥¼ ê¸°ë¡í•©ë‹ˆë‹¤.

### ëª©í‘œ

1. Hammerspoon ë©”ë‰´ë°”ì— ğŸ¢ ì•„ì´ì½˜ìœ¼ë¡œ ë™ê¸°í™” ìƒíƒœ í‘œì‹œ
2. ë™ê¸°í™” ì§€ì—° ì‹œ ì•Œë¦¼ ì „ì†¡ (Pushover, macOS ì•Œë¦¼)
3. ì„¤ì •ê°’ ì¤‘ì•™ ê´€ë¦¬ (í•˜ë“œì½”ë”© ì œê±°)

### ì‹œí–‰ì°©ì˜¤ 1: `last_sync_time` íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ

**ì´ˆê¸° êµ¬í˜„**: `~/.local/share/atuin/last_sync_time` íŒŒì¼ì˜ ë‚´ìš©ì„ íŒŒì‹±í•˜ì—¬ ë§ˆì§€ë§‰ ë™ê¸°í™” ì‹œê°„ í™•ì¸

**ë¬¸ì œ**: `atuin sync`ë¥¼ ì‹¤í–‰í•´ë„ `last_sync_time` íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ

```bash
# sync ì „
$ cat ~/.local/share/atuin/last_sync_time
2026-01-13T07:26:31.004161Z

# sync í›„ (ë³€í™” ì—†ìŒ!)
$ atuin sync
0/0 up/down to record store
Sync complete! 53 items in history database

$ cat ~/.local/share/atuin/last_sync_time
2026-01-13T07:26:31.004161Z  # ë™ì¼
```

**ì›ì¸**: atuin 18.xë¶€í„° **record-based sync (v2)**ë¥¼ ì‚¬ìš©í•˜ë©´ì„œ `last_sync_time` íŒŒì¼ì€ ë” ì´ìƒ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ. ì´ íŒŒì¼ì€ ë ˆê±°ì‹œ sync v1ìš©.

### ì‹œí–‰ì°©ì˜¤ 2: `records.db` mtimeë„ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ

**ë‘ ë²ˆì§¸ ì‹œë„**: `records.db` íŒŒì¼ì˜ ìˆ˜ì • ì‹œê°„(mtime)ì„ ì‚¬ìš©

**ë¬¸ì œ**: `atuin sync` ì‹¤í–‰ ì‹œ ë™ê¸°í™”í•  ë°ì´í„°ê°€ ì—†ìœ¼ë©´ (0/0 up/down) íŒŒì¼ì´ ìˆ˜ì •ë˜ì§€ ì•ŠìŒ

```bash
$ ls -la ~/.local/share/atuin/records.db
.rw-------@ 94k glen 13 Jan 16:54  # mtime ê³ ì •

$ atuin sync
0/0 up/down to record store
Sync complete!

$ ls -la ~/.local/share/atuin/records.db
.rw-------@ 94k glen 13 Jan 16:54  # ë³€í™” ì—†ìŒ
```

**ì›ì¸**: ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼ì€ ì‹¤ì œ ë°ì´í„° ë³€ê²½ì´ ìˆì„ ë•Œë§Œ ìˆ˜ì •ë¨.

### ìµœì¢… í•´ê²°: `atuin doctor`ì˜ `last_sync` ê°’ ì‚¬ìš©

**ì„¸ ë²ˆì§¸ ì‹œë„**: `atuin doctor` ëª…ë ¹ì˜ JSON ì¶œë ¥ì—ì„œ `last_sync` ê°’ ì¶”ì¶œ

```bash
$ atuin doctor 2>&1 | grep -o '"last_sync": "[^"]*"'
"last_sync": "2026-01-13 8:12:42.22629 +00:00:00"
```

ì´ ê°’ì€ atuin ë‚´ë¶€ì—ì„œ ê´€ë¦¬ë˜ë©°, syncê°€ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ì •í™•í•˜ê²Œ ì—…ë°ì´íŠ¸ë¨.

**êµ¬í˜„**:

```lua
-- Lua (Hammerspoon)
local output = hs.execute("atuin doctor 2>&1")
local lastSyncStr = output:match('"last_sync":%s*"([^"]+)"')
```

```bash
# Bash (watchdog ìŠ¤í¬ë¦½íŠ¸)
LAST_SYNC_RAW=$(atuin doctor 2>&1 | grep -o '"last_sync": "[^"]*"' | cut -d'"' -f4)
```

### ì‹œí–‰ì°©ì˜¤ 3: `auto_sync`ê°€ ë°±ê·¸ë¼ìš´ë“œ ì£¼ê¸° ë™ê¸°í™”ê°€ ì•„ë‹˜

**ì˜¤í•´**: `sync_frequency = "1m"` ì„¤ì •ì´ 1ë¶„ë§ˆë‹¤ ìë™ìœ¼ë¡œ ë°±ê·¸ë¼ìš´ë“œ syncë¥¼ ì‹¤í–‰í•œë‹¤ê³  ìƒê°

**ì‹¤ì œ ë™ì‘**: `auto_sync`ëŠ” **í„°ë¯¸ë„ì—ì„œ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œ í›„**ì—ë§Œ ë™ì‘

```
# ì˜ëª»ëœ ì´í•´
sync_frequency = "1m"  â†’ 1ë¶„ë§ˆë‹¤ ë°±ê·¸ë¼ìš´ë“œ sync? âŒ

# ì‹¤ì œ ë™ì‘
sync_frequency = "1m"  â†’ ëª…ë ¹ì–´ ì‹¤í–‰ í›„, ë§ˆì§€ë§‰ syncë¡œë¶€í„° 1ë¶„ì´ ì§€ë‚¬ìœ¼ë©´ sync ì‹œë„ âœ…
```

**ê²°ê³¼**: í„°ë¯¸ë„ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ syncê°€ ë°œìƒí•˜ì§€ ì•ŠìŒ â†’ 3ë¶„ ì „ì´ ë§ˆì§€ë§‰ ë™ê¸°í™”ì¸ ì´ìœ 

### í•´ê²°: daemon ëª¨ë“œ í™œì„±í™”

`~/.config/atuin/config.toml`ì— daemon ì„¤ì • ì¶”ê°€:

```toml
[sync]
records = true  # sync v2 í™œì„±í™”

[daemon]
enabled = true
sync_frequency = 60  # ì´ˆ ë‹¨ìœ„ (ë¬¸ìì—´ "1m"ì´ ì•„ë‹˜!)
```

ê·¸ë¦¬ê³  `atuin daemon`ì„ launchdë¡œ ìë™ ì‹œì‘:

```nix
launchd.agents.atuin-daemon = {
  enable = true;
  config = {
    Label = "com.green.atuin-daemon";
    ProgramArguments = [ ".../atuin" "daemon" ];
    RunAtLoad = true;
    KeepAlive = true;
  };
};
```

### ì‹œí–‰ì°©ì˜¤ 4: í•˜ë“œì½”ë”©ëœ ì„¤ì •ê°’

**ë¬¸ì œ**: ì„¤ì •ê°’ì´ ì—¬ëŸ¬ íŒŒì¼ì— ì¤‘ë³µ ì •ì˜ë¨

```lua
-- atuin_menubar.lua
local syncThresholdHours = 24
local logRetentionDays = 30
```

```nix
-- default.nix
syncThresholdHours = 24;
logRetentionDays = 30;
```

**í•´ê²°**: Single Source of Truth íŒ¨í„´ ì ìš©

```
default.nix (ì„¤ì •ê°’ ì •ì˜)
    â”‚
    â”œâ”€â”€â–¶ JSON íŒŒì¼ ìƒì„± â†’ Hammerspoonì—ì„œ ì½ê¸°
    â”‚
    â””â”€â”€â–¶ í™˜ê²½ë³€ìˆ˜ â†’ watchdog ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì½ê¸°
```

### ì‹œí–‰ì°©ì˜¤ 5: Hammerspoonì—ì„œ atuin ëª» ì°¾ìŒ

**ë¬¸ì œ**: ë©”ë‰´ë°”ì—ì„œ "ì§€ê¸ˆ ë™ê¸°í™”" ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ ë¡œê·¸ì— "Attempting sync..." ë©”ì‹œì§€ê°€ ì—†ìŒ

**ì›ì¸**: Hammerspoonì˜ PATHì— atuin ê²½ë¡œê°€ ì—†ìŒ

```lua
-- ìŠ¤í¬ë¦½íŠ¸ì˜ PATH
/run/current-system/sw/bin
$HOME/.nix-profile/bin
/opt/homebrew/bin
...

-- atuin ì‹¤ì œ ê²½ë¡œ (ëˆ„ë½!)
/etc/profiles/per-user/glen/bin/atuin
```

**í•´ê²°**: PATHì— per-user ê²½ë¡œ ì¶”ê°€

```bash
export PATH="/etc/profiles/per-user/$USER/bin:..."
```

### ìµœì¢… êµ¬í˜„ ê²°ê³¼

| í•­ëª© | ì´ˆê¸° | ìµœì¢… |
|------|------|------|
| sync ìƒíƒœ ì†ŒìŠ¤ | `last_sync_time` íŒŒì¼ | `atuin doctor` ì¶œë ¥ |
| ì„ê³„ê°’ | 24ì‹œê°„ | 5ë¶„ |
| ìƒíƒœ ì²´í¬ ì£¼ê¸° | 1ì‹œê°„ | 10ë¶„ |
| ë°±ê·¸ë¼ìš´ë“œ sync | ì—†ìŒ | daemon ëª¨ë“œ (60ì´ˆ) |
| ì„¤ì • ê´€ë¦¬ | í•˜ë“œì½”ë”© | JSON + í™˜ê²½ë³€ìˆ˜ |
| ìŠ¤í¬ë¦½íŠ¸ ì´ë¦„ | `atuin-sync-monitor` | `atuin-watchdog` |

### êµí›ˆ

1. **ê³µì‹ ë¬¸ì„œë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•¨**: atuinì˜ `auto_sync`, `sync_frequency` ë™ì‘ ë°©ì‹ì€ ë¬¸ì„œì— ëª…í™•íˆ ì„¤ëª…ë˜ì–´ ìˆì§€ ì•ŠìŒ. ì‹¤ì œ í…ŒìŠ¤íŠ¸ì™€ ì†ŒìŠ¤ ì½”ë“œ ë¶„ì„ì´ í•„ìš”.

2. **ë ˆê±°ì‹œ vs í˜„ì¬**: `last_sync_time` ê°™ì€ íŒŒì¼ì´ ì¡´ì¬í•´ë„ í˜„ì¬ ë²„ì „ì—ì„œ ì‚¬ìš©ë˜ëŠ”ì§€ í™•ì¸ í•„ìš”. atuinì€ sync v1 â†’ v2ë¡œ ì „í™˜í•˜ë©´ì„œ ë§ì€ ë‚´ë¶€ êµ¬ì¡°ê°€ ë³€ê²½ë¨.

3. **ë‹¨ì¼ ì†ŒìŠ¤ ì›ì¹™**: ì„¤ì •ê°’ì´ ì—¬ëŸ¬ ê³³ì— ë¶„ì‚°ë˜ë©´ ë””ë²„ê¹…ì´ ì–´ë ¤ì›€. ì²˜ìŒë¶€í„° ì¤‘ì•™ ê´€ë¦¬ ì„¤ê³„ ê¶Œì¥.

4. **PATH ë¬¸ì œ**: Nix í™˜ê²½ì—ì„œ Hammerspoon, launchd ë“± ì™¸ë¶€ ì‹¤í–‰ í™˜ê²½ì€ ì‰˜ê³¼ ë‹¤ë¥¸ PATHë¥¼ ê°€ì§. ëª…ì‹œì ìœ¼ë¡œ ì„¤ì • í•„ìš”.

---

## 2026-01-13: Atuin ê³„ì • ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤íŒ¨

> í…ŒìŠ¤íŠ¸ í™˜ê²½: atuin 18.10.0 (nixpkgs), 18.11.0 (GitHub ë¦´ë¦¬ìŠ¤), macOS Apple Silicon

### ëª©í‘œ

1. ê¸°ì¡´ ê³„ì •(glen)ì—ì„œ ìƒˆ ê³„ì •(greenhead)ìœ¼ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜
2. 62,000ê°œ ì´ìƒì˜ íˆìŠ¤í† ë¦¬ ë³´ì¡´
3. ë™ê¸°í™” ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬ì¶•

### ì´ˆê¸° ìƒíƒœ

```bash
$ cat ~/.local/share/atuin/last_sync_time
2025-09-26T04:11:39.71577ZZ  # ì•½ 4ê°œì›” ì „!

$ atuin status
Error: There was an error with the atuin sync service: Status 404.
```

- `atuin sync`ëŠ” "Sync complete!" ì¶œë ¥í•˜ì§€ë§Œ ì‹¤ì œë¡œ ë™ê¸°í™” ì•ˆ ë¨
- `last_sync_time` ì—…ë°ì´íŠ¸ ì•ˆ ë¨

### ì‹œë„ ê³¼ì •

#### 1ë‹¨ê³„: ìƒˆ ê³„ì • ìƒì„± ì‹œë„

```bash
# ë°±ì—…
cp ~/.local/share/atuin/{history.db,key,records.db} ~/.local/share/atuin/*.backup-20260113

# ë¡œê·¸ì•„ì›ƒ í›„ ìƒˆ ê³„ì • ë“±ë¡
atuin logout
atuin register -u greenhead -e <email>
```

**ë¬¸ì œ**: ìƒˆ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ë„ `atuin status`ì—ì„œ ë™ì¼í•œ 404 ì˜¤ë¥˜

#### 2ë‹¨ê³„: ë°ì´í„° ì´ˆê¸°í™” ë° ì¬ì‹œë„

```bash
rm -f ~/.local/share/atuin/{history.db,key,session,host_id,records.db,...}
atuin login -u greenhead
```

**ë¬¸ì œ**: ì„œë²„ì—ì„œ ê¸°ì¡´ íˆìŠ¤í† ë¦¬ ë‹¤ìš´ë¡œë“œ ì‹œ encryption key ë¶ˆì¼ì¹˜

```
Error: attempting to decrypt with incorrect key.
currently using k4.lid.XXX..., expecting k4.lid.YYY...
```

#### 3ë‹¨ê³„: ë°±ì—… key ë³µì› ì‹œë„

```bash
cp ~/.local/share/atuin/key.backup-20260113 ~/.local/share/atuin/key
atuin sync
```

**ê²°ê³¼**:
- ì„œë²„ì— ë‘ ê°œì˜ í˜¸ìŠ¤íŠ¸ ì¡´ì¬ (ê¸°ì¡´ + ìƒˆë¡œ ìƒì„±)
- ê° í˜¸ìŠ¤íŠ¸ê°€ ë‹¤ë¥¸ keyë¡œ ì•”í˜¸í™”ëœ ë°ì´í„° ë³´ìœ 
- ì–´ë–¤ keyë¥¼ ì‚¬ìš©í•´ë„ ì¼ë¶€ ë°ì´í„° ë³µí˜¸í™” ì‹¤íŒ¨

#### 4ë‹¨ê³„: ë²„ì „ ì—…ê·¸ë ˆì´ë“œ ì‹œë„

```bash
# 18.11.0 ì§ì ‘ ë‹¤ìš´ë¡œë“œ
curl -sLO https://github.com/atuinsh/atuin/releases/download/v18.11.0/atuin-aarch64-apple-darwin.tar.gz
./atuin-aarch64-apple-darwin/atuin status
```

**ê²°ê³¼**: ë™ì¼í•œ 404 ì˜¤ë¥˜. í´ë¼ì´ì–¸íŠ¸ ë²„ì „ ë¬¸ì œê°€ ì•„ë‹˜.

#### 5ë‹¨ê³„: ì†ŒìŠ¤ ì½”ë“œ ë¶„ì„

```bash
git clone https://github.com/atuinsh/atuin.git ~/IdeaProjects/atuin-source
```

**ë°œê²¬** (`crates/atuin-server/src/router.rs`):

```rust
// Sync v1 routes - can be disabled in favor of record-based sync
if settings.sync_v1_enabled {
    routes = routes
        .route("/sync/status", get(handlers::status::status))
        // ...
}
```

**ê·¼ë³¸ ì›ì¸**: Atuin í´ë¼ìš°ë“œ ì„œë²„(`api.atuin.sh`)ê°€ Sync v1ì„ ë¹„í™œì„±í™”í•¨
- `/sync/status` ì—”ë“œí¬ì¸íŠ¸ê°€ ë” ì´ìƒ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
- `atuin status`ëŠ” v1 APIë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ 404 ë°˜í™˜
- `atuin sync`ëŠ” v2 API (`/api/v0/*`)ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ì •ìƒ ì‘ë™

### ìµœì¢… ê²°ê³¼

| í•­ëª© | ê²°ê³¼ |
|------|------|
| ê³„ì • ë§ˆì´ê·¸ë ˆì´ì…˜ | âŒ í¬ê¸° (key ì¶©ëŒ í•´ê²° ë¶ˆê°€) |
| ê¸°ì¡´ íˆìŠ¤í† ë¦¬ ë³´ì¡´ | âŒ ì†ì‹¤ (ë°±ì—… íŒŒì¼ ì‚­ì œë¨) |
| ë™ê¸°í™” ëª¨ë‹ˆí„°ë§ | âœ… êµ¬í˜„ ì™„ë£Œ |
| `atuin status` 404 | âš ï¸ ì„œë²„ ì¸¡ ë¬¸ì œ, í•´ê²° ë¶ˆê°€ |

### êµí›ˆ

1. **ë°±ì—…ì€ ì—¬ëŸ¬ ê³³ì—**: ì‘ì—… ì¤‘ì— ë°±ì—… íŒŒì¼ì´ ì‚­ì œë¨. ë³„ë„ ê²½ë¡œì—ë„ ë°±ì—… í•„ìš”.

2. **Encryption keyëŠ” ì‹ ì¤‘í•˜ê²Œ**:
   - ìƒˆ ê³„ì • ë¡œê·¸ì¸ ì‹œ ìƒˆ keyê°€ ìë™ ìƒì„±ë¨
   - ê¸°ì¡´ keyë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë¡œê·¸ì¸ í”„ë¡¬í”„íŠ¸ì—ì„œ ì…ë ¥ í•„ìš”
   - keyê°€ ë‹¤ë¥´ë©´ ì„œë²„ ë°ì´í„° ë³µí˜¸í™” ë¶ˆê°€

3. **404 ì˜¤ë¥˜ì˜ ë‹¤ì–‘í•œ ì›ì¸**:
   - ì²˜ìŒì—ëŠ” ì„¸ì…˜/ì¸ì¦ ë¬¸ì œë¡œ ì¶”ì •
   - ì‹¤ì œë¡œëŠ” ì„œë²„ API ë¹„í™œì„±í™” (Sync v1 deprecated)

4. **ì†ŒìŠ¤ ì½”ë“œ ë¶„ì„ì˜ ì¤‘ìš”ì„±**:
   - ì—ëŸ¬ ë©”ì‹œì§€ë§Œìœ¼ë¡œëŠ” ì›ì¸ íŒŒì•… ì–´ë ¤ì›€
   - ì‹¤ì œ ì„œë²„/í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ ì½ì–´ì•¼ ì •í™•í•œ ì›ì¸ ë°œê²¬

### ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `modules/darwin/programs/atuin/default.nix` | launchd ì—ì´ì „íŠ¸ ì„¤ì • |
| `modules/darwin/programs/atuin/files/atuin-sync-monitor.sh` | ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸ |
| `docs/TROUBLESHOOTING.md` | Atuin ì„¹ì…˜ |
| `docs/ATUIN_ACCOUNT_MIGRATION.md` | ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ (ë¯¸ì™„ì„±) |

### í–¥í›„ ê³„íš

- [ ] Atuin GitHubì— ì´ìŠˆ ì œì¶œ (status 404 ë¬¸ì œ)
- [ ] ì§‘ ë§¥ë¶ì—ì„œ ë™ì¼í•œ ì„¤ì • ì ìš©
- [ ] ê¸°ì¡´ íˆìŠ¤í† ë¦¬ëŠ” í¬ê¸°, ìƒˆë¡œ ì‹œì‘

---

## 2026-01-11: Claude Code ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸ í•´ê²°

> í…ŒìŠ¤íŠ¸ í™˜ê²½: Claude Code 2.1.4, macOS

### ë°°ê²½

`settings.json`ì˜ `enabledPlugins`ì—ì„œ í”ŒëŸ¬ê·¸ì¸ í”„ë¡œí¼í‹°ë¥¼ ì§ì ‘ ì‚­ì œí•˜ë©´ **ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸(ghost plugin)** ë¬¸ì œê°€ ë°œìƒ:

| ìƒíƒœ | ì¦ìƒ |
|------|------|
| `/plugin` ëª…ë ¹ | í”ŒëŸ¬ê·¸ì¸ì´ "ì„¤ì¹˜ë¨"ìœ¼ë¡œ í‘œì‹œ |
| ì„¤ì • ë³€ê²½ | í™œì„±í™”/ë¹„í™œì„±í™” í† ê¸€ ë¶ˆê°€ |
| í”ŒëŸ¬ê·¸ì¸ ê¸°ëŠ¥ | ë™ì‘í•˜ì§€ ì•ŠìŒ |

### ì‹œë„ 1: ë§ˆì¼“í”Œë ˆì´ìŠ¤ ì¬ì„¤ì¹˜ (ì‹¤íŒ¨)

```bash
claude plugin marketplace remove claude-plugins-official
claude plugin marketplace add anthropics/claude-plugins-official
```

**ê²°ê³¼**: âŒ ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸ ì—¬ì „íˆ ì¡´ì¬

ë§ˆì¼“í”Œë ˆì´ìŠ¤ë¥¼ ì¬ì„¤ì¹˜í•´ë„ ê¸°ì¡´ `enabledPlugins` ìƒíƒœì™€ì˜ ë™ê¸°í™” ë¬¸ì œëŠ” í•´ê²°ë˜ì§€ ì•ŠìŒ.

### í•´ê²°: settings.jsonì— ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸ ì§ì ‘ ëª…ì‹œ

**ì›ë¦¬**: Claude Codeê°€ í”ŒëŸ¬ê·¸ì¸ì„ ì¸ì‹í•˜ë ¤ë©´ `enabledPlugins`ì— í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì´ ì¡´ì¬í•´ì•¼ í•¨. ìœ ë ¹ ìƒíƒœì—ì„œëŠ” CLIë„ í”ŒëŸ¬ê·¸ì¸ì„ ì°¾ì§€ ëª»í•¨.

**í•´ê²° ìˆœì„œ**:

1. `settings.json`ì— ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸ì„ ë‹¤ì‹œ ëª…ì‹œ:
   ```json
   "enabledPlugins": {
     "ghost-plugin-name@marketplace": true
   }
   ```

2. Claude Code ì¬ì‹œì‘ (ë˜ëŠ” `/plugin` ëª…ë ¹ìœ¼ë¡œ í™•ì¸)

3. CLIë¡œ í”ŒëŸ¬ê·¸ì¸ ì œê±°:
   ```bash
   claude plugin uninstall ghost-plugin-name@marketplace --scope user
   ```

4. ì •ìƒì ìœ¼ë¡œ ì œê±°ë¨ í™•ì¸

### êµí›ˆ

1. **í”ŒëŸ¬ê·¸ì¸ ì œê±°ëŠ” ë°˜ë“œì‹œ CLI ì‚¬ìš©**
   - `settings.json` ì§ì ‘ í¸ì§‘ìœ¼ë¡œ í”ŒëŸ¬ê·¸ì¸ì„ ì‚­ì œí•˜ë©´ ë™ê¸°í™” ë¬¸ì œ ë°œìƒ
   - `claude plugin uninstall` ëª…ë ¹ ì‚¬ìš© í•„ìˆ˜

2. **ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸ ë³µêµ¬ ë°©ë²•**
   - `settings.json`ì— ìœ ë ¹ í”ŒëŸ¬ê·¸ì¸ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ì—¬ Claude Codeê°€ ì¸ì‹í•˜ê²Œ ë§Œë“  í›„ CLIë¡œ ì œê±°
   - ë§ˆì¼“í”Œë ˆì´ìŠ¤ ì¬ì„¤ì¹˜ë¡œëŠ” í•´ê²° ë¶ˆê°€

3. **Nix ì„ ì–¸ì  ê´€ë¦¬ ì‹œ ì£¼ì˜**
   - `mkOutOfStoreSymlink`ë¡œ `settings.json` ê´€ë¦¬ ì‹œ, ì§ì ‘ í¸ì§‘ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ ì‹¤ìˆ˜ ê°€ëŠ¥
   - í”ŒëŸ¬ê·¸ì¸ ê´€ë ¨ ë³€ê²½ì€ í•­ìƒ Claude Code CLI ì‚¬ìš© ê¶Œì¥

---

## 2026-01-10: cat â†’ bat alias ì œê±° (í˜¸í™˜ì„± ë¬¸ì œ)

> í…ŒìŠ¤íŠ¸ í™˜ê²½: bat 0.26.1, macOS cat

### ë°°ê²½

`cat` ëª…ë ¹ì–´ë¥¼ `bat`ìœ¼ë¡œ aliasí•˜ì—¬ ê¸°ë³¸ íŒŒì¼ ì¶œë ¥ì— êµ¬ë¬¸ ê°•ì¡°ë¥¼ ì ìš©í•˜ë ¤ í–ˆìŒ.

```nix
# modules/shared/programs/shell/default.nix
home.shellAliases = {
  # íŒŒì¼ ì¶œë ¥ (bat ì‚¬ìš©)
  cat = "bat";
};
```

### ê¸°ëŒ€

`bat`ì´ `cat`ì˜ ì™„ì „í•œ ìƒìœ„í˜¸í™˜ì´ë¼ê³  ê°€ì •:

- ëª¨ë“  `cat` ì˜µì…˜ì´ `bat`ì—ì„œë„ ë™ì¼í•˜ê²Œ ì‘ë™
- ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ë‚˜ ëª…ë ¹ì–´ê°€ ì˜í–¥ë°›ì§€ ì•ŠìŒ

### ì‹¤íŒ¨ ì›ì¸

**`bat`ì€ `cat`ì˜ ìƒìœ„í˜¸í™˜ì´ ì•„ë‹˜.** ì¼ë¶€ ì˜µì…˜ì€ í˜¸í™˜ë˜ì§€ë§Œ, í•µì‹¬ ì§„ë‹¨ ì˜µì…˜ë“¤ì´ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚´.

macOS cat ì˜µì…˜: `cat [-belnstuv]`

| ì˜µì…˜ | macOS cat ë™ì‘ | bat 0.26.1 ë™ì‘ |
|------|----------------|-----------------|
| `-v` | ë¹„ì¶œë ¥ ë¬¸ì í‘œì‹œ (`^A`, `^[` ë“±) | âŒ ì—ëŸ¬: `unexpected argument '-v' found` |
| `-e` | ì¤„ ëì— `$` í‘œì‹œ + `-v` ì•”ì‹œ | âŒ ì—ëŸ¬ |
| `-t` | íƒ­ì„ `^I`ë¡œ í‘œì‹œ + `-v` ì•”ì‹œ | âŒ ì—ëŸ¬ |
| `-b` | ë¹„ì–´ìˆì§€ ì•Šì€ ì¤„ì—ë§Œ ë²ˆí˜¸ | âŒ ì—ëŸ¬ |
| `-n` | ëª¨ë“  ì¤„ì— ë²ˆí˜¸ | âœ… ë™ì¼ (`-n, --number`) |
| `-s` | ì—°ì† ë¹ˆ ì¤„ ì••ì¶• | âœ… ë™ì¼ (`-s, --squeeze-blank`) |
| `-u` | ë²„í¼ë§ ë¹„í™œì„±í™” | âœ… ë™ì¼ (`-u, --unbuffered`) |
| `-A` | âŒ macOSì—ì„œ ë¯¸ì§€ì› (GNU cat ì „ìš©) | âœ… ì§€ì› (`-A, --show-all`) |

**ì‹¤ì œ ë¬¸ì œ ìƒí™©:**

```bash
# CSI u ëª¨ë“œ ì§„ë‹¨ ì‹œ í‚¤ ì…ë ¥ í…ŒìŠ¤íŠ¸ (TROUBLESHOOTING.md ì°¸ì¡°)
cat -v
# ê¸°ëŒ€: ì…ë ¥ ëŒ€ê¸° í›„ ë¹„ì¶œë ¥ ë¬¸ì í‘œì‹œ
# ì‹¤ì œ (alias ì ìš© ì‹œ): ì—ëŸ¬ ë°œìƒ
#   error: unexpected argument '-v' found
#     tip: to pass '-v' as a value, use '-- -v'
```

### í•´ê²°

alias ì œê±°:

```nix
home.shellAliases = {
  # cat = "bat";  # ì‚­ì œ: -v, -e, -t, -b ì˜µì…˜ ë¹„í˜¸í™˜
};
```

`bat`ì€ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , `cat`ì€ ì›ë³¸ ìœ ì§€.

### êµí›ˆ

1. **CLI ë„êµ¬ alias ì „ì— ì˜µì…˜ í˜¸í™˜ì„± í™•ì¸ í•„ìˆ˜**
   - "ìƒìœ„í˜¸í™˜"ì´ë¼ëŠ” ê°€ì •ì€ ìœ„í—˜
   - íŠ¹íˆ ì‹œìŠ¤í…œ ìœ í‹¸ë¦¬í‹°(`cat`, `ls`, `grep` ë“±)ëŠ” ì˜µì…˜ ì²´ê³„ê°€ í‘œì¤€í™”ë˜ì–´ ìˆìŒ

2. **aliasê°€ ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸/ë¬¸ì„œì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆìŒ**
   - ë¬¸ì„œì— `cat -v` ê°™ì€ ëª…ë ¹ì–´ê°€ ìˆìœ¼ë©´ aliasë¡œ ì¸í•´ ì˜¤ì‘ë™
   - ë””ë²„ê¹… ì‹œ í˜¼ë€ ì•¼ê¸°

3. **ëŒ€ì²´ ë„êµ¬ëŠ” ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ì•ˆì „**
   - `bat file.txt` (ëª…ì‹œì )
   - `cat file.txt` (aliasë¡œ bat í˜¸ì¶œ) â† í˜¼ë€ ìœ ë°œ

4. **ë¶€ë¶„ í˜¸í™˜ì€ ë” ìœ„í—˜í•  ìˆ˜ ìˆìŒ**
   - `-n`, `-s`, `-u`ëŠ” í˜¸í™˜ë˜ì–´ í‰ì†Œì—ëŠ” ë¬¸ì œì—†ì´ ì‘ë™
   - íŠ¹ì • ìƒí™©(ì§„ë‹¨, ë””ë²„ê¹…)ì—ì„œë§Œ `-v` ë“±ì„ ì‚¬ìš©í•  ë•Œ ê°‘ìê¸° ì‹¤íŒ¨
   - "ì˜ ë˜ë‹¤ê°€ ê°‘ìê¸° ì•ˆ ë¨" â†’ ì›ì¸ íŒŒì•…ì´ ì–´ë ¤ì›€

---

## 2026-01-10: VS Code customLabelsì—ì„œ ë™ì  ì•± ì´ë¦„ ì¶”ì¶œ ì‹¤íŒ¨

> í…ŒìŠ¤íŠ¸ í™˜ê²½: Cursor 2.3.33 (VS Code 1.93.0 ê¸°ë°˜)

### ë°°ê²½

Next.js Page Router + Turbopack ëª¨ë…¸ë ˆí¬ êµ¬ì¡°ì—ì„œ ì—ë””í„° íƒ­ ë ˆì´ë¸”ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ë ¤ í–ˆìŒ. ì—¬ëŸ¬ ì•±(`web`, `admin`, `mobile` ë“±)ì˜ `pages/` í´ë”ì—ì„œ ë™ì¼í•œ íŒŒì¼ëª…(`index.tsx`)ì´ ì—´ë¦´ ë•Œ êµ¬ë¶„í•˜ê¸° ì–´ë ¤ìš´ ë¬¸ì œ.

**ëª©í‘œ**: `apps/admin/pages/settings/index.tsx` â†’ `(admin) settings/index.tsx`

### ì‹œë„ 1: Named Capture Group ë¬¸ë²• (ì‹¤íŒ¨)

ì •ê·œì‹ì˜ Named Capture Groupì„ ì‚¬ìš©í•˜ì—¬ ì•± ì´ë¦„ì„ ë™ì ìœ¼ë¡œ ì¶”ì¶œí•˜ë ¤ ì‹œë„.

```json
"**/apps/${app:([^/]+)}/pages/**/index.{ts,tsx}": "(${app}) ${dirname}/index.${extname}"
```

**ê²°ê³¼**: ë™ì‘í•˜ì§€ ì•ŠìŒ.

**ì›ì¸**: VS Codeì˜ `customLabels.patterns`ëŠ” Named Capture Groupì´ë‚˜ ì •ê·œì‹ ìº¡ì²˜ë¥¼ **ì§€ì›í•˜ì§€ ì•ŠìŒ**.

### ì‹œë„ 2: `**` ì™€ì¼ë“œì¹´ë“œ + `${dirname(N)}` ì¡°í•© (ì‹¤íŒ¨)

`**` íŒ¨í„´ìœ¼ë¡œ ê°€ë³€ ê¹Šì´ ê²½ë¡œë¥¼ ë§¤ì¹­í•˜ê³ , `${dirname(N)}`ìœ¼ë¡œ íŠ¹ì • ìœ„ì¹˜ì˜ í´ë”ëª…ì„ ì¶”ì¶œí•˜ë ¤ ì‹œë„.

```json
"**/apps/*/pages/**/index.{ts,tsx}": "(${dirname(3)}) ${dirname}/index.${extname}"
```

**ê²°ê³¼**: ì•± ì´ë¦„ì´ ì•„ë‹Œ ë‹¤ë¥¸ í´ë”ëª…ì´ í‘œì‹œë¨.

| ê²½ë¡œ | ê¸°ëŒ€ ê²°ê³¼ | ì‹¤ì œ ê²°ê³¼ |
|------|----------|----------|
| `apps/admin/pages/settings/index.tsx` | `(admin) settings/index.tsx` | `(apps) settings/index.tsx` |
| `apps/admin/pages/a/b/index.tsx` | `(admin) b/index.tsx` | `(pages) b/index.tsx` |

**ì›ì¸**: `${dirname(N)}`ì€ **íŒŒì¼ ê¸°ì¤€ ì ˆëŒ€ ì¸ë±ì‹±**ì´ë¯€ë¡œ, `**`ê°€ ë§¤ì¹­í•˜ëŠ” ê²½ë¡œ ê¹Šì´ì— ë”°ë¼ Në²ˆì§¸ í´ë”ê°€ ë‹¬ë¼ì§.

### VS Code customLabelsì˜ í•œê³„

**ì§€ì›ë˜ëŠ” ë³€ìˆ˜ (ì „ë¶€)**:

| ë³€ìˆ˜ | ì„¤ëª… |
|------|------|
| `${filename}` | í™•ì¥ì ì œì™¸ íŒŒì¼ëª… |
| `${extname}` | í™•ì¥ì |
| `${dirname}` | ì§ì ‘ ìƒìœ„ í´ë”ëª… |
| `${dirname(N)}` | Në²ˆì§¸ ìƒìœ„ í´ë”ëª… (íŒŒì¼ ê¸°ì¤€ ì ˆëŒ€ ì¸ë±ì‹±) |

**ì§€ì›ë˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥**:

- Named Capture Group (`${name:pattern}`)
- ì •ê·œì‹ ìº¡ì²˜ (`$1`, `$2`)
- íŒ¨í„´ ë§¤ì¹­ ìœ„ì¹˜ ê¸°ë°˜ ë³€ìˆ˜ ì¶”ì¶œ
- `**` ì™€ì¼ë“œì¹´ë“œì™€ ìƒëŒ€ì  ì¸ë±ì‹± ì¡°í•©

### í•´ê²° ë°©ë²• (ìš°íšŒ)

ì•±ë³„ë¡œ ëª…ì‹œì ì¸ íŒ¨í„´ì„ ì‘ì„±í•˜ëŠ” ìˆ˜ë°–ì— ì—†ìŒ.

```json
"**/apps/web/pages/**/index.{ts,tsx}": "(web) ${dirname}/index.${extname}",
"**/apps/admin/pages/**/index.{ts,tsx}": "(admin) ${dirname}/index.${extname}",
"**/apps/mobile/pages/**/index.{ts,tsx}": "(mobile) ${dirname}/index.${extname}"
```

**ë‹¨ì **: ì•±ì´ ì¶”ê°€ë  ë•Œë§ˆë‹¤ íŒ¨í„´ì„ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€í•´ì•¼ í•¨.

### êµí›ˆ

1. **VS Code customLabelsëŠ” ë‹¨ìˆœí•œ í…œí”Œë¦¿ ì¹˜í™˜ë§Œ ì§€ì›**
   - ì •ê·œì‹ ìº¡ì²˜, ë™ì  ë³€ìˆ˜ ì¶”ì¶œ ë“± ê³ ê¸‰ ê¸°ëŠ¥ ì—†ìŒ
   - glob íŒ¨í„´ì€ íŒŒì¼ ë§¤ì¹­ìš©ì¼ ë¿, ê°’ ì¶”ì¶œìš©ì´ ì•„ë‹˜

2. **`${dirname(N)}`ì€ ì ˆëŒ€ ì¸ë±ì‹±**
   - íŒŒì¼ ìœ„ì¹˜ ê¸°ì¤€ìœ¼ë¡œ ê³ ì •ëœ ê¹Šì´ë§Œ ì°¸ì¡° ê°€ëŠ¥
   - `**` ì™€ì¼ë“œì¹´ë“œì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ê²°ê³¼

3. **ëª¨ë…¸ë ˆí¬ì—ì„œëŠ” ì•±ë³„ ëª…ì‹œì  íŒ¨í„´ì´ í•„ìš”**
   - ë™ì ìœ¼ë¡œ ì•± ì´ë¦„ì„ ì¶”ì¶œí•˜ëŠ” ë°©ë²• ì—†ìŒ
   - ì•± ëª©ë¡ì´ ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ìˆ˜ë™ ê´€ë¦¬ê°€ í˜„ì‹¤ì 

---

## 2024-12-25: dutië¡œ .html/.htm ê¸°ë³¸ ì•± ì„¤ì • ì‹¤íŒ¨

### ë°°ê²½

macOSì—ì„œ í…ìŠ¤íŠ¸/ì½”ë“œ íŒŒì¼(.txt, .md, .js ë“±)ì„ ë”ë¸”í´ë¦­ ì‹œ Xcode ëŒ€ì‹  Cursorë¡œ ì—´ë¦¬ë„ë¡ `duti`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¤ì •.

### ì‹œë„í•œ ë‚´ìš©

```nix
codeExtensions = [
  "txt" "text" "md" "mdx" "js" "jsx" "ts" "tsx" "mjs" "cjs"
  "json" "yaml" "yml" "toml" "html" "htm" "css" "scss" "sass" "less"
  # ... ê¸°íƒ€ í™•ì¥ì
];

home.activation.setCursorAsDefaultEditor = lib.hm.dag.entryAfter [ "writeBoundary" ] ''
  ${lib.concatMapStringsSep "\n" (ext:
    "${pkgs.duti}/bin/duti -s ${cursorBundleId} .${ext} all"
  ) codeExtensions}
'';
```

### ê²°ê³¼

```
failed to set com.todesktop.230313mzl4w4u92 as handler for public.html (error -54)
```

- **error -54**: macOS ê¶Œí•œ ì—ëŸ¬ (`permErr`)
- `.html`, `.htm` í™•ì¥ìë§Œ ì‹¤íŒ¨, ë‚˜ë¨¸ì§€ëŠ” ì„±ê³µ

### ì›ì¸ ë¶„ì„

1. **Safariê°€ `public.html` UTIë¥¼ ì‹œìŠ¤í…œ ìˆ˜ì¤€ì—ì„œ ì„ ì **
   - macOSëŠ” Safarië¥¼ HTML íŒŒì¼ì˜ ê¸°ë³¸ í•¸ë“¤ëŸ¬ë¡œ ê°•í•˜ê²Œ ë³´í˜¸
   - `duti`ê°€ `public.html` UTI ì„¤ì • ì‹œë„ ì‹œ ê¶Œí•œ ê±°ë¶€ë¨

2. **dutiì˜ í™•ì¥ì ì„¤ì • ë™ì‘**
   - `.html` í™•ì¥ì ì„¤ì • ì‹œ ë‚´ë¶€ì ìœ¼ë¡œ `public.html` UTIë„ í•¨ê»˜ ì„¤ì • ì‹œë„
   - UTI ì„¤ì • ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ì¶œë ¥ (ì¹˜ëª…ì ì´ì§€ ì•ŠìŒ)

### í•´ê²° ë°©ë²•

**ë°©ë²• 1: í™•ì¥ì ëª©ë¡ì—ì„œ html/htm ì œê±° (ì ìš©)**

```nix
codeExtensions = [
  "txt" "text" "md" "mdx" "js" "jsx" "ts" "tsx" "mjs" "cjs"
  "json" "yaml" "yml" "toml" "css" "scss" "sass" "less"  # html, htm ì œê±°
  # ...
];
```

**ë°©ë²• 2: Finderì—ì„œ ìˆ˜ë™ ì„¤ì • (í•„ìš”ì‹œ)**

1. `.html` íŒŒì¼ ìš°í´ë¦­ â†’ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (Cmd+I)
2. "ë‹¤ìŒìœ¼ë¡œ ì—´ê¸°" â†’ Cursor ì„ íƒ â†’ "ëª¨ë‘ ë³€ê²½" í´ë¦­

### êµí›ˆ

1. **macOS Launch ServicesëŠ” ì‹œìŠ¤í…œ ì•±(Safari, Preview ë“±)ì„ ë³´í˜¸í•¨**
   - íŠ¹ì • UTIëŠ” ì‚¬ìš©ìê°€ ë³€ê²½í•  ìˆ˜ ì—†ë„ë¡ ì ê²¨ ìˆìŒ
   - CLI ë„êµ¬ë¡œ ê°•ì œ ë³€ê²½ ë¶ˆê°€

2. **duti ì—ëŸ¬ëŠ” ì¹˜ëª…ì ì´ì§€ ì•ŠìŒ**
   - ê°œë³„ í™•ì¥ì ì„¤ì • ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ í™•ì¥ìì— ì˜í–¥ ì—†ìŒ
   - activation ì „ì²´ê°€ ì¤‘ë‹¨ë˜ì§€ ì•ŠìŒ

3. **HTML íŒŒì¼ì€ ë¸Œë¼ìš°ì €ë¡œ ì—¬ëŠ” ê²ƒì´ macOS ê¸°ë³¸ ì •ì±…**
   - ê°œë°œì ì›Œí¬í”Œë¡œìš°ì™€ ì¶©ëŒí•˜ëŠ” ë¶€ë¶„
   - í•„ìš”ì‹œ ìˆ˜ë™ ì„¤ì •ìœ¼ë¡œ ëŒ€ì‘

---

## 2024-12-24: Anki ì• ë“œì˜¨ Nix ì„ ì–¸ì  ê´€ë¦¬ ì‹œë„ (ë³´ë¥˜)

### ëª©í‘œ

Anki ì• ë“œì˜¨ 10ê°œë¥¼ Nixë¡œ ì„ ì–¸ì  ê´€ë¦¬í•˜ì—¬ ì¬í˜„ ê°€ëŠ¥í•œ í™˜ê²½ êµ¬ì¶•.

### ì‹œë„í•œ ë°©ì‹ë“¤

#### ë°©ì‹ 1: AnkiWeb ì§ì ‘ ë‹¤ìš´ë¡œë“œ (ì‹¤íŒ¨)

AnkiWebì—ì„œ ì• ë“œì˜¨ì„ ì§ì ‘ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ê´€ë¦¬í•˜ëŠ” ë°©ì‹.

```
https://ankiweb.net/shared/download/{addon_id}
```

**ì‹¤íŒ¨ ì›ì¸:** AnkiWebì˜ ë‹¤ìš´ë¡œë“œ URLì€ ì§ì ‘ ì ‘ê·¼ì„ ì°¨ë‹¨í•¨. ë¸Œë¼ìš°ì € ì„¸ì…˜/ì¿ í‚¤ê°€ í•„ìš”í•˜ì—¬ `fetchurl`ë¡œ ë‹¤ìš´ë¡œë“œ ë¶ˆê°€.

---

#### ë°©ì‹ 2: ë¡œì»¬ ì†ŒìŠ¤ íŒ¨í‚¤ì§• (ë°˜ë ¤)

ì• ë“œì˜¨ ì†ŒìŠ¤ ì½”ë“œë¥¼ nixos-config ì €ì¥ì†Œì— ì§ì ‘ í¬í•¨í•˜ì—¬ ê´€ë¦¬í•˜ëŠ” ë°©ì‹.

```
modules/darwin/programs/anki/
â””â”€â”€ sources/
    â”œâ”€â”€ 24411424/
    â”œâ”€â”€ 31746032/
    â””â”€â”€ ...
```

**ë°˜ë ¤ ì‚¬ìœ :** ê° ì• ë“œì˜¨ì˜ ì†ŒìŠ¤ì½”ë“œ(ìˆ˜ë°± ê°œ íŒŒì¼)ë¥¼ ì „ë¶€ gitìœ¼ë¡œ ê´€ë¦¬í•´ì•¼ í•˜ë¯€ë¡œ ì €ì¥ì†Œ ê·œëª¨ê°€ ë„ˆë¬´ ì»¤ì§. diffë„ ê³¼ë„í•˜ê²Œ ë§ì´ ë°œìƒ.

---

#### ë°©ì‹ 3: GitHub ì €ì¥ì†Œ í™œìš© (ë³´ë¥˜)

`fetchFromGitHub`ë¥¼ ì‚¬ìš©í•˜ì—¬ GitHubì—ì„œ ì• ë“œì˜¨ ì†ŒìŠ¤ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ë°©ì‹.

```nix
pkgs.fetchFromGitHub {
  owner = "addon-author";
  repo = "addon-repo";
  rev = "<commit-hash>";
  sha256 = "...";
};
```

**ìƒì„±í–ˆë˜ íŒŒì¼ êµ¬ì¡°:**

```
modules/darwin/programs/anki/
â”œâ”€â”€ default.nix          # ë©”ì¸ ëª¨ë“ˆ
â”œâ”€â”€ addons.nix           # fetchFromGitHub ì• ë“œì˜¨ ì •ì˜
â””â”€â”€ files/               # ì„¤ì • íŒŒì¼
    â”œâ”€â”€ customize-shortcuts-meta.json
    â”œâ”€â”€ add-hyperlink-config.json
    â”œâ”€â”€ note-linker-config.json
    â””â”€â”€ add-table-config.json
```

### ë°©ì‹ 3ì˜ ì‹¤íŒ¨ ì›ì¸

#### 1. GitHub ì €ì¥ì†Œ êµ¬ì¡° ë¶ˆì¼ì¹˜

ëŒ€ë¶€ë¶„ì˜ Anki ì• ë“œì˜¨ GitHub ì €ì¥ì†ŒëŠ” ê°œë°œìš© êµ¬ì¡°ë¡œ ë˜ì–´ ìˆìŒ:
- `src/` ë””ë ‰í† ë¦¬ì— ì†ŒìŠ¤ ì½”ë“œ
- `forms6/` (Qt Designer UI íŒŒì¼ì—ì„œ ë¹Œë“œë˜ëŠ” Python ëª¨ë“ˆ)ì´ ë¹Œë“œë˜ì–´ì•¼ í•¨
- AnkiWeb ë°°í¬íŒì—ë§Œ ë¹Œë“œëœ íŒŒì¼ì´ í¬í•¨ë¨

| ì• ë“œì˜¨ | ë¬¸ì œì  |
|---|---|
| Add Table (1237621971) | `forms6` ëª¨ë“ˆ ëˆ„ë½ |
| Add Hyperlink (318752047) | `forms6` ëª¨ë“ˆ ëˆ„ë½ |
| Customize Shortcuts (24411424) | Qt ë²„ì „ í˜¸í™˜ì„± ë¬¸ì œ |

#### 2. ì €ì¥ì†Œë³„ srcDir ìƒì´

ê° ì €ì¥ì†Œë§ˆë‹¤ ì‹¤ì œ ì• ë“œì˜¨ íŒŒì¼ ìœ„ì¹˜ê°€ ë‹¤ë¦„:
- `custom_shortcuts/` (24411424)
- `src/` (31746032, 318752047, 1237621971)
- `src/image_occlusion_enhanced/` (1374772155)
- `src/enhanced_cloze/` (1990296174)
- `.` ë£¨íŠ¸ (1077002392, 1124670306)

### êµí›ˆ

1. **AnkiWeb ë°°í¬íŒ vs GitHub ì†ŒìŠ¤ëŠ” ë‹¤ë¥´ë‹¤**
   - GitHub ì†ŒìŠ¤ì—ëŠ” ë¹Œë“œ ê³¼ì •ì—ì„œ ìƒì„±ë˜ëŠ” íŒŒì¼(`forms6/` ë“±)ì´ ì—†ìŒ
   - `fetchFromGitHub` ë°©ì‹ì€ ëŒ€ë¶€ë¶„ì˜ ì• ë“œì˜¨ì—ì„œ ì‘ë™í•˜ì§€ ì•ŠìŒ

2. **ì‘ì—… ì „ í•­ìƒ ë°±ì—…**
   - ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê¸° ì „ì— ë°˜ë“œì‹œ ë°±ì—… ìƒì„±
   - íŠ¹íˆ ì„¤ì • íŒŒì¼, ì»¤ìŠ¤í…€ ì„¤ì •ì´ ìˆëŠ” ê²½ìš°

3. **Anki ì• ë“œì˜¨ ê´€ë¦¬ì˜ í˜„ì‹¤ì  ëŒ€ì•ˆ**
   - AnkiWebì—ì„œ ì§ì ‘ ì„¤ì¹˜/ê´€ë¦¬ (ê¸°ì¡´ ë°©ì‹)
   - AnkiWeb APIë¥¼ ì‚¬ìš©í•œ ë‹¤ìš´ë¡œë“œ (ë¶ˆì•ˆì •í•  ìˆ˜ ìˆìŒ)
   - ì• ë“œì˜¨ë³„ ë¦´ë¦¬ìŠ¤ ì•„í‹°íŒ©íŠ¸ ì‚¬ìš© (ìˆëŠ” ê²½ìš°ì—ë§Œ)

### ëŒ€ìƒ ì• ë“œì˜¨ ëª©ë¡ (ì°¸ê³ ìš©)

| ID | ì´ë¦„ |
|---|---|
| 24411424 | Customize Keyboard Shortcuts |
| 31746032 | AnkiWebView Inspector |
| 318752047 | Add Hyperlink |
| 805891399 | Extended Editor for Field |
| 1077002392 | Anki Note Linker |
| 1124670306 | Set Added Date |
| 1237621971 | Add Table |
| 1374772155 | Image Occlusion Enhanced |
| 1990296174 | Enhanced Cloze |
| 2491935955 | Quick Colour Changing |

### ê²°ë¡ 

Anki ì• ë“œì˜¨ì˜ Nix ì„ ì–¸ì  ê´€ë¦¬ëŠ” **í˜„ì‹¤ì ìœ¼ë¡œ ì–´ë ¤ì›€**. AnkiWebì—ì„œ ì§ì ‘ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì •ì .

---

## 2026-01-14: Atuin Watchdog ê°œì„  ë° Daemon ë¹„í™œì„±í™”

### ë°°ê²½

íšŒì‚¬ í™˜ê²½ì—ì„œ atuin daemon ì¬ì‹œì‘ í›„ì—ë„ ë™ê¸°í™” ì§€ì—°ì´ ì§€ì†ë˜ëŠ” ë¬¸ì œ ë°œìƒ. ì›ì¸ íŒŒì•… ë° í•´ê²° ê³¼ì • ê¸°ë¡.

### íƒ€ì„ë¼ì¸ (ì‚¬ì‹¤ ê¸°ë°˜)

| ì‹œì  | ì»¤ë°‹ | ë‚´ìš© |
|------|------|------|
| 2026-01-13 17:55 | b44bea2 | daemon ëª¨ë“œ í™œì„±í™”, atuin doctor ì‚¬ìš© ì‹œì‘ |
| 2026-01-14 08:54 | fb8de27 | "ë™ê¸°í™” ì§€ì—° (1948ë¶„ ì´ˆê³¼)" ë¬¸ì œ ë°œê²¬, daemon ìë™ ë³µêµ¬ ê¸°ëŠ¥ ì¶”ê°€ |
| 2026-01-14 11:00ê²½ | ì´ë²ˆ ì„¸ì…˜ | daemon ì—¬ì „íˆ ë¶ˆì•ˆì •, CLI syncë¡œ ì™„ì „ ëŒ€ì²´ ê²°ì • |

**ì£¼ëª©í•  ì **: b44bea2ì—ì„œ daemonì„ í™œì„±í™”í•œ í›„ ì•½ 15ì‹œê°„ ë§Œì— 1948ë¶„(32ì‹œê°„) ë™ê¸°í™” ì§€ì—°ì´ ë°œê²¬ë¨. ì´ëŠ” **daemonì´ í™œì„±í™” ì§í›„ë¶€í„° ì •ìƒ ë™ì‘í•˜ì§€ ì•Šì•˜ì„ ê°€ëŠ¥ì„±**ì„ ì‹œì‚¬í•¨.

### í•µì‹¬ ë°œê²¬: daemon sync vs CLI syncì˜ ì°¨ì´

ì†ŒìŠ¤ì½”ë“œ ë¶„ì„ì„ í†µí•´ ì¤‘ìš”í•œ ì°¨ì´ì  ë°œê²¬:

**daemon sync** (`atuin-daemon/src/server/sync.rs:85`):
```rust
// sync ì„±ê³µ í›„ save_sync_time() í˜¸ì¶œ
tokio::task::spawn_blocking(Settings::save_sync_time).await??;
```

**CLI sync (v2)** (`crates/atuin/src/command/client/sync.rs`):
```rust
pub async fn run(...) -> Result<()> {
    if settings.sync.records {
        // v2 ê²½ë¡œ: save_sync_time() í˜¸ì¶œ ì—†ìŒ
        sync::sync(&settings, &db).await?;
    } else {
        // v1 ê²½ë¡œ: save_sync_time() ìˆìŒ
        atuin_client::sync::sync(&settings, false, &db).await?;
    }
}
```

**ê²°ë¡ **:
- daemonì´ ì •ìƒ ë™ì‘í•˜ë©´ `last_sync_time` íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë¨
- CLI sync (v2)ëŠ” `save_sync_time()`ì„ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ (ë²„ê·¸ë¡œ ì¶”ì •ë˜ë‚˜ í™•ì‹¤í•˜ì§€ ì•ŠìŒ)

### ì´ì „ ì»¤ë°‹(b44bea2)ì´ ë™ì‘í–ˆë˜ ì´ìœ ì— ëŒ€í•œ ë¶„ì„

**ì‚¬ì‹¤**:
- b44bea2 ì»¤ë°‹ì—ì„œëŠ” daemon ëª¨ë“œë¥¼ í™œì„±í™”í•˜ê³ , `atuin doctor`ì˜ `last_sync` ê°’ì„ ì‚¬ìš©
- daemon sync ì½”ë“œì—ëŠ” `save_sync_time()` í˜¸ì¶œì´ ì¡´ì¬í•¨

**ì¶”ì¸¡**:
- daemonì´ ì •ìƒ ë™ì‘í–ˆë‹¤ë©´ `save_sync_time()`ì´ í˜¸ì¶œë˜ì–´ `last_sync_time` íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆì„ ê²ƒ
- í•˜ì§€ë§Œ fb8de27 ì»¤ë°‹(í™œì„±í™” í›„ ì•½ 15ì‹œê°„)ì—ì„œ 1948ë¶„ ì§€ì—°ì´ ë°œê²¬ëœ ê²ƒìœ¼ë¡œ ë³´ì•„, **daemonì´ ì²˜ìŒë¶€í„° ì •ìƒ ë™ì‘í•˜ì§€ ì•Šì•˜ì„ ê°€ëŠ¥ì„±**ì´ ë†’ìŒ
- "ì •ìƒ ë™ì‘ í›„ ë¬¸ì œ ë°œìƒ"ì´ ì•„ë‹ˆë¼ "í™œì„±í™” ì§í›„ë¶€í„° ë¬¸ì œ ë°œìƒ"ì´ì—ˆì„ ìˆ˜ ìˆìŒ

### ê´€ì°°ëœ daemon ë¶ˆì•ˆì • ì¦ìƒ

**í™•ì¸ëœ ì‚¬ì‹¤** (ì´ë²ˆ ì„¸ì…˜ì—ì„œ ì§ì ‘ í™•ì¸):

```bash
$ launchctl print gui/$(id -u)/com.green.atuin-daemon
runs = 218
last exit code = 1
```

- daemonì´ 218ë²ˆ ì¬ì‹œì‘ë¨
- ë§ˆì§€ë§‰ ì¢…ë£Œ ì½”ë“œê°€ 1 (ì—ëŸ¬)

**ì¶”ì¸¡ë˜ëŠ” ì›ì¸** (í™•ì¸ë˜ì§€ ì•ŠìŒ):
- ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë¶ˆì•ˆì • ì‹œ ë³µêµ¬ ì‹¤íŒ¨
- ì‹œìŠ¤í…œ ìŠ¬ë¦½/ì›¨ì´í¬ í›„ ë³µêµ¬ ì‹¤íŒ¨
- ì„œë²„ ì¸¡ ì¼ì‹œì  ì¥ì•  í›„ ì¬ì—°ê²° ì‹¤íŒ¨
- atuin daemon ìì²´ì˜ experimental íŠ¹ì„±ìœ¼ë¡œ ì¸í•œ ë¶ˆì•ˆì •

**ì°¸ê³ **: atuin ê³µì‹ ë¬¸ì„œì—ì„œ daemonì„ "experimental" ê¸°ëŠ¥ìœ¼ë¡œ ë¶„ë¥˜í•˜ê³  ìˆìŒ. maintainerë„ ë¶ˆì•ˆì •í•˜ë‹¤ê³  ì–¸ê¸‰í•œ ì  ìˆìŒ (ì •í™•í•œ ì¶œì²˜ í•„ìš”).

### ë¬¸ì œ 1: Watchdogì´ ì—ëŸ¬ë¥¼ ë¬´ì‹œí•¨

**ì¦ìƒ**: watchdogì´ sync ì‹¤íŒ¨ë¥¼ ê°ì§€í•˜ì§€ ëª»í•¨

**ì›ì¸**: ê¸°ì¡´ ì½”ë“œê°€ ì—ëŸ¬ë¥¼ ë¬´ì‹œ

```bash
# ê¸°ì¡´ ì½”ë“œ
atuin sync 2>/dev/null || echo "Warning: sync command failed"
```

**í•´ê²°**: ì—ëŸ¬ ë¡œê¹… ë° ìƒì„¸ ì¶œë ¥ ì¶”ê°€

```bash
sync_output=$(atuin sync 2>&1)
sync_exit_code=$?
if [[ $sync_exit_code -ne 0 ]]; then
    log_error "Sync failed (exit code: $sync_exit_code)"
    log_error "Sync output: $sync_output"
fi
```

### ë¬¸ì œ 2: ë„¤íŠ¸ì›Œí¬ ë¬¸ì œì™€ daemon ë¬¸ì œ êµ¬ë¶„ ë¶ˆê°€

**ì¦ìƒ**: ë„¤íŠ¸ì›Œí¬ê°€ ì•ˆ ë˜ëŠ”ë° daemonì„ ì¬ì‹œì‘í•˜ë ¤ê³  ì‹œë„

**í•´ê²°**: sync ì‹œë„ ì „ ë„¤íŠ¸ì›Œí¬ í™•ì¸ ì¶”ê°€

```bash
check_network_connectivity() {
    # DNS í™•ì¸
    if ! host "$ATUIN_SYNC_SERVER" >/dev/null 2>&1; then
        log_error "DNS resolution failed"
        return 1
    fi

    # HTTPS ì—°ê²° í™•ì¸
    http_code=$(curl -s -o /dev/null -w "%{http_code}" \
        --connect-timeout 5 "https://$ATUIN_SYNC_SERVER")

    if [[ "$http_code" == "000" ]]; then
        log_error "No response from server"
        return 1
    fi

    return 0
}
```

### ë¬¸ì œ 3: Atuin daemon ë¶ˆì•ˆì •

**ì¦ìƒ**: daemonì´ exit code 1ë¡œ 218ë²ˆ ì¬ì‹œì‘ë¨

```bash
$ launchctl print gui/$(id -u)/com.green.atuin-daemon
runs = 218
last exit code = 1
```

**ì›ì¸ ë¶„ì„**:
- atuin daemonì€ ì•„ì§ experimental ê¸°ëŠ¥
- maintainerë„ ë¶ˆì•ˆì •í•˜ë‹¤ê³  ì–¸ê¸‰
- ì¥ì‹œê°„ ì‹¤í–‰ ì‹œ ì¢€ë¹„ ìƒíƒœë¡œ ì „í™˜

**í•´ê²°**: daemon ë¹„í™œì„±í™”, launchdë¡œ ì£¼ê¸°ì  sync ì‹¤í–‰

```nix
# daemon ë¹„í™œì„±í™” (config.toml)
# daemon = { enabled = true; ... }  # ì£¼ì„ ì²˜ë¦¬

# launchdë¡œ 2ë¶„ë§ˆë‹¤ sync
launchd.agents.atuin-sync = {
  config = {
    ProgramArguments = [ "/bin/bash" "-c" "atuin sync && ..." ];
    StartInterval = 120;
  };
};
```

### ë¬¸ì œ 4: CLI sync (v2)ê°€ last_sync_time ë¯¸ì—…ë°ì´íŠ¸

**ì¦ìƒ**: `atuin sync` ì„±ê³µí•´ë„ `last_sync_time` íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ

**ì›ì¸**: atuin ì†ŒìŠ¤ì½”ë“œ ë¶„ì„ ê²°ê³¼, sync.records = true (v2) ê²½ë¡œì—ì„œ `save_sync_time()` ë¯¸í˜¸ì¶œ

```rust
// crates/atuin/src/command/client/sync.rs
pub async fn run(...) -> Result<()> {
    if settings.sync.records {
        sync::sync(&settings, &db).await?;  // save_sync_time() ì—†ìŒ!
    } else {
        atuin_client::sync::sync(...).await?;  // save_sync_time() ìˆìŒ
    }
}
```

**í•´ê²°**: launchdì—ì„œ sync ì„±ê³µ í›„ ì§ì ‘ íŒŒì¼ ì—…ë°ì´íŠ¸

```bash
atuin sync && printf '%s' "$(date -u +'%Y-%m-%dT%H:%M:%S.000000Z')" > ~/.local/share/atuin/last_sync_time
```

### ë¬¸ì œ 5: last_sync_time íŒŒì¼ í˜•ì‹ ì˜¤ë¥˜

**ì¦ìƒ**: `atuin doctor`ê°€ "no last sync" ë°˜í™˜

**ì›ì¸**: ì¤„ë°”ê¿ˆ ë¬¸ìê°€ í¬í•¨ë˜ë©´ íŒŒì‹± ì‹¤íŒ¨

```bash
# ì˜ëª»ëœ ë°©ì‹
echo "2026-01-14T02:45:00.000000Z" > last_sync_time  # ì¤„ë°”ê¿ˆ í¬í•¨!

# ì˜¬ë°”ë¥¸ ë°©ì‹
printf '%s' "2026-01-14T02:45:00.000000Z" > last_sync_time  # ì¤„ë°”ê¿ˆ ì—†ìŒ
```

### ë¬¸ì œ 6: launchd ì—ì´ì „íŠ¸ê°€ ì¦‰ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

**ì¦ìƒ**: `StartInterval = 120` ì„¤ì • ì‹œ ì²« intervalì´ ì§€ë‚œ í›„ì—ì•¼ ì‹¤í–‰ë¨

**í•´ê²°**: `RunAtLoad = true` ì¶”ê°€

```nix
launchd.agents.atuin-sync = {
  config = {
    RunAtLoad = true;      # ë¡œë“œ ì‹œ ë°”ë¡œ ì²« ì‹¤í–‰
    StartInterval = 120;   # ì´í›„ 2ë¶„ë§ˆë‹¤
  };
};
```

### êµí›ˆ

1. **ì—ëŸ¬ë¥¼ ë¬´ì‹œí•˜ì§€ ë§ ê²ƒ**
   - `2>/dev/null`ì€ ë””ë²„ê¹…ì„ ë¶ˆê°€ëŠ¥í•˜ê²Œ ë§Œë“¦
   - ì—ëŸ¬ ì¶œë ¥ì„ ë¡œê·¸ íŒŒì¼ì— ê¸°ë¡í•˜ëŠ” ê²ƒì´ í•„ìˆ˜

2. **ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ìš°ì„  í™•ì¸**
   - ì•± ë¬¸ì œì¸ì§€ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œì¸ì§€ êµ¬ë¶„ í•„ìš”
   - sync ì‹¤íŒ¨ ì‹œ ë¬´ì¡°ê±´ daemon/ì•± ì¬ì‹œì‘ì´ ì•„ë‹Œ, ë„¤íŠ¸ì›Œí¬ í™•ì¸ ì„ í–‰

3. **experimental ê¸°ëŠ¥ì— ëŒ€í•œ ëŒ€ë¹„**
   - "experimental"ë¡œ í‘œì‹œëœ ê¸°ëŠ¥ì€ ì‹¤ì œë¡œ ë¶ˆì•ˆì •í•  ìˆ˜ ìˆìŒ
   - ëŒ€ì•ˆ(fallback)ì„ ë¯¸ë¦¬ ë§ˆë ¨í•´ë‘ëŠ” ê²ƒì´ ì¢‹ìŒ
   - ì´ë²ˆ ê²½ìš°: daemon ëŒ€ì‹  launchd + CLI sync ì¡°í•©ìœ¼ë¡œ ëŒ€ì²´

4. **ì†ŒìŠ¤ì½”ë“œ ë¶„ì„ì˜ ì¤‘ìš”ì„±**
   - ë¬¸ì„œë§Œìœ¼ë¡œëŠ” ë™ì‘ì„ í™•ì‹ í•  ìˆ˜ ì—†ìŒ
   - `save_sync_time()` ë¯¸í˜¸ì¶œ ê°™ì€ ë¯¸ë¬˜í•œ ì°¨ì´ëŠ” ì†ŒìŠ¤ì½”ë“œì—ì„œë§Œ í™•ì¸ ê°€ëŠ¥
   - ë²„ê·¸ì¸ì§€ ì˜ë„ëœ ë™ì‘ì¸ì§€ íŒë‹¨í•˜ë ¤ë©´ ì†ŒìŠ¤ì½”ë“œ ë¶„ì„ í•„ìˆ˜

5. **íŒŒì¼ í˜•ì‹ì˜ ì—„ê²©í•¨**
   - ì¤„ë°”ê¿ˆ í•˜ë‚˜ê°€ íŒŒì‹± ì‹¤íŒ¨ ìœ ë°œ (`echo` vs `printf '%s'`)
   - ì‹œê°„ í˜•ì‹, íƒ€ì„ì¡´ ë“± ì •í™•íˆ ë§ì¶°ì•¼ í•¨

6. **launchd ë™ì‘ ì´í•´**
   - `StartInterval`ë§Œìœ¼ë¡œëŠ” ì¦‰ì‹œ ì‹¤í–‰ ì•ˆ ë¨
   - `RunAtLoad = true` ì¶”ê°€í•´ì•¼ ë¡œë“œ ì‹œ ì²« ì‹¤í–‰

7. **ì»¤ë°‹ ë©”ì‹œì§€ì™€ íƒ€ì„ë¼ì¸ì˜ ì¤‘ìš”ì„±**
   - fb8de27 ì»¤ë°‹ ë©”ì‹œì§€ì— "1948ë¶„ ë™ê¸°í™” ì§€ì—°"ì´ ê¸°ë¡ë¨
   - ì´ ì •ë³´ë¡œ "daemonì´ ì²˜ìŒë¶€í„° ë¬¸ì œì˜€ë‹¤"ëŠ” ê²ƒì„ ì—­ì¶”ì í•  ìˆ˜ ìˆì—ˆìŒ
   - ë¬¸ì œ ìƒí™©ì„ ì»¤ë°‹ ë©”ì‹œì§€ì— ìƒì„¸íˆ ê¸°ë¡í•˜ëŠ” ê²ƒì´ ë‚˜ì¤‘ì— ë„ì›€ì´ ë¨

### ìµœì¢… ì•„í‚¤í…ì²˜

```
launchd
â”œâ”€â”€ com.green.atuin-sync      # 2ë¶„ë§ˆë‹¤: atuin sync + last_sync_time ì—…ë°ì´íŠ¸
â””â”€â”€ com.green.atuin-watchdog  # 10ë¶„ë§ˆë‹¤: ë„¤íŠ¸ì›Œí¬ í™•ì¸ + ìƒíƒœ ì²´í¬ + ë³µêµ¬ + ì•Œë¦¼
```

**ì™œ ì´ êµ¬ì¡°ì¸ê°€:**
- daemonì€ ë¶ˆì•ˆì • â†’ launchdì˜ `StartInterval`ë¡œ ì£¼ê¸°ì  sync ëŒ€ì²´
- CLI sync (v2)ëŠ” `last_sync_time` ë¯¸ì—…ë°ì´íŠ¸ â†’ launchdì—ì„œ ì§ì ‘ íŒŒì¼ ì—…ë°ì´íŠ¸
- watchdogì€ ìƒíƒœ ì²´í¬ + ë³µêµ¬ ì „ë‹´ (sync ìì²´ëŠ” ë‹´ë‹¹í•˜ì§€ ì•ŠìŒ)

### ë°œê²¬í•œ atuin ë™ì‘ íŠ¹ì„±

> **ì£¼ì˜**: ì•„ë˜ ë‚´ìš©ì´ "ë²„ê·¸"ì¸ì§€ "ì˜ë„ëœ ë™ì‘"ì¸ì§€ëŠ” í™•ì¸ë˜ì§€ ì•ŠìŒ. upstreamì— í™•ì¸ í•„ìš”.

#### 1. sync ê²½ë¡œë³„ save_sync_time() í˜¸ì¶œ ì—¬ë¶€ (ì¤‘ìš”!)

atuinì—ëŠ” ì—¬ëŸ¬ sync ê²½ë¡œê°€ ì¡´ì¬í•˜ë©°, ê°ê° `save_sync_time()` í˜¸ì¶œ ì—¬ë¶€ê°€ ë‹¤ë¦„.

**ì „ì²´ ë¹„êµí‘œ**:

| sync ê²½ë¡œ | save_sync_time() | ì†ŒìŠ¤ì½”ë“œ ìœ„ì¹˜ | íŠ¸ë¦¬ê±° |
|-----------|------------------|---------------|--------|
| CLI `atuin sync` (v2) | âŒ ë¯¸í˜¸ì¶œ | `crates/atuin/src/command/client/sync.rs` | ìˆ˜ë™ ì‹¤í–‰, launchd ë“± |
| CLI `atuin sync` (v1) | âœ… í˜¸ì¶œ | ë™ì¼ íŒŒì¼, v1 ê²½ë¡œ | (ë ˆê±°ì‹œ) |
| history end (auto_sync) | âœ… í˜¸ì¶œ | `crates/atuin/src/command/client/history.rs:460-462` | í„°ë¯¸ë„ ëª…ë ¹ ì‹¤í–‰ í›„ |
| daemon sync | âœ… í˜¸ì¶œ | `atuin-daemon/src/server/sync.rs:85` | daemon ë‚´ë¶€ ìŠ¤ì¼€ì¤„ëŸ¬ |

**í•µì‹¬ ë°œê²¬ (2026-01-14 ì¶”ê°€ ë¶„ì„)**:

ì²˜ìŒì—ëŠ” "CLI sync (v2)ê°€ save_sync_time()ì„ í˜¸ì¶œí•˜ì§€ ì•ŠëŠ”ë‹¤"ëŠ” ê²ƒë§Œ íŒŒì•…í–ˆìœ¼ë‚˜, ì¶”ê°€ ë¶„ì„ ê²°ê³¼ **history endì˜ auto_syncëŠ” save_sync_time()ì„ í˜¸ì¶œí•œë‹¤**ëŠ” ê²ƒì„ ë°œê²¬í•¨.

**ì†ŒìŠ¤ì½”ë“œ ì¦ê±°** (`crates/atuin/src/command/client/history.rs:457-462`):

```rust
if settings.should_sync()? {
    #[cfg(feature = "sync")]
    {
        if settings.sync.records {
            let (_, downloaded) = record::sync::sync(settings, &store).await?;
            Settings::save_sync_time()?;  // <-- ì—¬ê¸°ì„œ í˜¸ì¶œ!

            crate::sync::build(settings, &store, db, Some(&downloaded)).await?;
        } else {
            // v1 ê²½ë¡œ
        }
    }
}
```

**CLI sync (v2)ì™€ì˜ ë¹„êµ** (`crates/atuin/src/command/client/sync.rs`):

```rust
pub async fn run(...) -> Result<()> {
    if settings.sync.records {
        sync::sync(&settings, &db).await?;  // save_sync_time() ì—†ìŒ!
    } else {
        atuin_client::sync::sync(&settings, false, &db).await?;
    }
}
```

**ì‹¤ì œ í…ŒìŠ¤íŠ¸ ê²°ê³¼** (2026-01-14 12:19):

```bash
$ cat ~/.local/share/atuin/last_sync_time
2026-01-14T03:18:46.000000Z

$ atuin sync
Uploading 1 records to 019bb5a9bc45768099cfb54cf73beb4a/history
2/0 up/down to record store
Sync complete! 51976 items in history database, force: false

$ cat ~/.local/share/atuin/last_sync_time
2026-01-14T03:18:46.000000Z  # ë³€ê²½ ì—†ìŒ!
```

CLI `atuin sync` ì‹¤í–‰ ì „í›„ë¡œ íŒŒì¼ì´ ë³€ê²½ë˜ì§€ ì•ŠìŒ. ë°˜ë©´, í„°ë¯¸ë„ì—ì„œ ì¼ë°˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ auto_syncê°€ íŠ¸ë¦¬ê±°ë˜ì–´ íŒŒì¼ì´ ì—…ë°ì´íŠ¸ë¨.

**auto_sync ë™ì‘ ë°©ì‹**:

1. í„°ë¯¸ë„ì—ì„œ ëª…ë ¹ ì‹¤í–‰ (ì˜ˆ: `ls`, `git status` ë“±)
2. atuinì´ history end ì²˜ë¦¬
3. `should_sync()` ì²´í¬: ë§ˆì§€ë§‰ sync ì´í›„ `sync_frequency` (ê¸°ë³¸ 1ë¶„) ì§€ë‚¬ëŠ”ê°€?
4. ì¡°ê±´ ì¶©ì¡± ì‹œ sync ì‹¤í–‰ + `save_sync_time()` í˜¸ì¶œ
5. `last_sync_time` íŒŒì¼ ì—…ë°ì´íŠ¸

**`should_sync()` í•¨ìˆ˜** (`crates/atuin-client/src/settings.rs:629-645`):

```rust
pub fn should_sync(&self) -> Result<bool> {
    if !self.auto_sync || !PathBuf::from(self.session_path.as_str()).exists() {
        return Ok(false);
    }

    if self.sync_frequency == "0" {
        return Ok(true);
    }

    match parse_duration(self.sync_frequency.as_str()) {
        Ok(d) => {
            let d = time::Duration::try_from(d)?;
            Ok(OffsetDateTime::now_utc() - Settings::last_sync()? >= d)
        }
        Err(e) => Err(eyre!("failed to check sync: {}", e)),
    }
}
```

**ì‹œì‚¬ì **:

1. **í„°ë¯¸ë„ ì‚¬ìš© ì‹œ**: auto_syncê°€ `sync_frequency` ê°„ê²©ìœ¼ë¡œ sync + save_sync_time() í˜¸ì¶œ
2. **í„°ë¯¸ë„ ë¯¸ì‚¬ìš© ì‹œ**: auto_sync íŠ¸ë¦¬ê±° ì•ˆ ë¨ â†’ launchdì˜ ì£¼ê¸°ì  sync í•„ìš”
3. **launchdì˜ CLI sync**: save_sync_time() ë¯¸í˜¸ì¶œ â†’ ì§ì ‘ íŒŒì¼ ì—…ë°ì´íŠ¸ workaround í•„ìš”

**ê²°ë¡ **:

launchdì—ì„œ `atuin sync` ì‹¤í–‰ í›„ ì§ì ‘ íŒŒì¼ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” workaroundëŠ”:
- í„°ë¯¸ë„ ì‚¬ìš© ì‹œ: ë¶ˆí•„ìš” (auto_syncê°€ ì²˜ë¦¬)
- í„°ë¯¸ë„ ë¯¸ì‚¬ìš© ì‹œ: í•„ìš” (CLI syncê°€ íŒŒì¼ ë¯¸ì—…ë°ì´íŠ¸)

ë”°ë¼ì„œ í˜„ì¬ ì„¤ì • (launchdì—ì„œ sync + íŒŒì¼ ì—…ë°ì´íŠ¸)ì€ **í„°ë¯¸ë„ ë¯¸ì‚¬ìš© ì‹œë¥¼ ìœ„í•œ ë°±ì—…**ìœ¼ë¡œ ìœ íš¨í•¨.

**ì¶”ì¸¡**: CLI sync (v2)ì—ì„œ save_sync_time() ë¯¸í˜¸ì¶œì€ ë²„ê·¸ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ. history end ê²½ë¡œì—ì„œëŠ” í˜¸ì¶œí•˜ë©´ì„œ CLI ê²½ë¡œì—ì„œë§Œ ëˆ„ë½ëœ ê²ƒì€ ì¼ê´€ì„±ì´ ì—†ìŒ.

#### 2. daemon ë¶ˆì•ˆì •

**ê´€ì°°ëœ í˜„ìƒ**:
- launchdì—ì„œ 218ë²ˆ ì¬ì‹œì‘ë¨ (runs = 218)
- exit code 1ë¡œ ë°˜ë³µ ì¢…ë£Œ
- í”„ë¡œì„¸ìŠ¤ëŠ” ì‹¤í–‰ ì¤‘ì´ì§€ë§Œ syncë¥¼ ìˆ˜í–‰í•˜ì§€ ì•ŠëŠ” "ì¢€ë¹„" ìƒíƒœ ë°œìƒ

**ì¶”ì¸¡ë˜ëŠ” ì›ì¸** (í™•ì¸ë˜ì§€ ì•ŠìŒ):
- experimental ê¸°ëŠ¥ì˜ íŠ¹ì„±
- ë„¤íŠ¸ì›Œí¬/ìŠ¬ë¦½/ì„œë²„ ì¥ì•  ì‹œ ë³µêµ¬ ì‹¤íŒ¨

**atuin ë¬¸ì„œ ì°¸ê³ **: daemonì€ "experimental" ê¸°ëŠ¥ìœ¼ë¡œ ë¶„ë¥˜ë¨.

### í–¥í›„ ê³ ë ¤ì‚¬í•­

1. **atuin upstream ì´ìŠˆ í™•ì¸/ë³´ê³ **
   - CLI sync (v2)ì˜ `save_sync_time()` ë¯¸í˜¸ì¶œì´ ë²„ê·¸ì¸ì§€ í™•ì¸
   - daemon ë¶ˆì•ˆì • ê´€ë ¨ ê¸°ì¡´ ì´ìŠˆê°€ ìˆëŠ”ì§€ í™•ì¸

2. **daemon ì•ˆì •í™” ì‹œ ì¬ê²€í† **
   - atuin ë²„ì „ ì—…ê·¸ë ˆì´ë“œ ì‹œ daemon ì•ˆì •ì„± ì¬í‰ê°€
   - ì•ˆì •í™”ë˜ë©´ daemonìœ¼ë¡œ ë³µê·€ ê°€ëŠ¥ (ë” íš¨ìœ¨ì )

3. **ëª¨ë‹ˆí„°ë§ ë¡œê·¸ ì£¼ê¸°ì  í™•ì¸**
   - `~/.local/share/atuin/watchdog.log` í™•ì¸
   - ìƒˆë¡œìš´ íŒ¨í„´ì˜ ë¬¸ì œ ë°œìƒ ì‹œ ì¡°ê¸° ë°œê²¬
